webpackJsonp([10],{Bmk8:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("Dd8w"),i=n.n(o),a=n("NYxO"),s={data:function(){return{address:"",addressPoint:void 0,hasBoundary:!1,map:void 0,localPosition:void 0,localPositionPoint:void 0}},mounted:function(){var t=this;setTimeout(function(){t.initMap()},20)},methods:i()({initMap:function(){var t=this;this.address=this.$route.query.address;var e=new BMap.Map("allmap");this.map=e,e.addEventListener("touchstart",function(){t.$refs.addressinput.blur()}),this.search(e),this.addControlMap(e),this.getBoundaryMap(e)},addControlMap:function(t){var e=this,n=new BMap.NavigationControl({anchor:BMAP_ANCHOR_BOTTOM_RIGHT,type:BMAP_NAVIGATION_CONTROL_SMALL,enableGeolocation:!0});t.addControl(n);var o=new BMap.GeolocationControl;o.addEventListener("locationSuccess",function(t){var n="";n+=t.addressComponent.province,n+=t.addressComponent.city,n+=t.addressComponent.district,n+=t.addressComponent.street,n+=t.addressComponent.streetNumber,e.localAddress=n,e.localPositionPoint=t.point}),o.addEventListener("locationError",function(t){alert(t.message)}),t.addControl(o);var i=new BMap.MapTypeControl({mapTypes:[BMAP_NORMAL_MAP,BMAP_HYBRID_MAP],anchor:BMAP_ANCHOR_TOP_LEFT});t.addControl(i)},getGeocoder:function(t){var e=this;(new BMap.Geocoder).getPoint(this.address,function(n){n?(e.addressPoint=n,e.hasBoundary||t.centerAndZoom(n,14),t.addOverlay(new BMap.Marker(n))):alert("您选择地址没有解析到结果!")})},getBoundaryMap:function(t){var e=this;(new BMap.Boundary).get(this.address,function(n){var o=n.boundaries.length;if(0!==o){e.hasBoundary=!0;for(var i=[],a=0;a<o;a++){var s=new BMap.Polygon(n.boundaries[a],{strokeWeight:2,strokeColor:"#ff0000"});t.addOverlay(s),i=i.concat(s.getPath())}e.getGeocoder(t),t.setViewport(i)}else e.getGeocoder(t)})},search:function(t){function e(t){return document.getElementById(t)}var n,o=new BMap.Autocomplete({input:"suggestId",location:t});o.addEventListener("onhighlight",function(t){var n="",o=t.fromitem.value,i="";t.fromitem.index>-1&&(i=o.province+o.city+o.district+o.street+o.business),n="FromItem<br />index = "+t.fromitem.index+"<br />value = "+i,i="",t.toitem.index>-1&&(i=(o=t.toitem.value).province+o.city+o.district+o.street+o.business),n+="<br />ToItem<br />index = "+t.toitem.index+"<br />value = "+i,e("searchResultPanel").innerHTML=n}),o.addEventListener("onconfirm",function(o){var i=o.item.value;n=i.province+i.city+i.district+i.street+i.business,e("searchResultPanel").innerHTML="onconfirm<br />index = "+o.item.index+"<br />myValue = "+n,function(){t.clearOverlays();var e=new BMap.LocalSearch(t,{onSearchComplete:function(){var n=e.getResults().getPoi(0).point;t.centerAndZoom(n,18),t.addOverlay(new BMap.Marker(n))}});e.search(n)}()})}},Object(a.c)({setRouteMsg:"SET_ROUTEMSG_MUTATION"})),beforeRouteLeave:function(t,e,n){"RouteView"===t.name&&this.setRouteMsg({address:this.address,addressPoint:this.addressPoint,localPosition:this.localPosition,localPositionPoint:this.localPositionPoint}),n()}},r={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"map"},[e("div",{staticClass:"searchBar",attrs:{id:"r-result"}},[e("input",{ref:"addressinput",attrs:{id:"suggestId",placeholder:"搜索",type:"text"}}),this._v(" "),e("div",{staticStyle:{border:"1px solid #C0C0C0",width:"150px",height:"auto",display:"none"},attrs:{id:"searchResultPanel"}})]),this._v(" "),e("router-link",{staticClass:"routeview",attrs:{to:"/RouteView"}},[e("p",{staticClass:"icon"},[e("i",{staticClass:"icon iconfont icon-daohang-tianchong"})]),this._v(" "),e("p",{staticClass:"text"},[this._v("路线")])]),this._v(" "),e("div",{attrs:{id:"allmap"}})],1)},staticRenderFns:[]};var d=n("VU/8")(s,r,!1,function(t){n("QB/W")},"data-v-ba6ce41e",null);e.default=d.exports},"QB/W":function(t,e){}});
//# sourceMappingURL=Map.d697ecb2d8b703bcd8f7.js.map